stages:
  gbif_backbone_taxon:
    cmd: unzip -d gbif gbif/backbone.zip Taxon.tsv
    deps:
      - gbif/backbone.zip
    outs:
      - gbif/Taxon.tsv

  master_2025:
    cmd: wget -o mm/master_2025.csv 'https://docs.google.com/spreadsheets/d/1lcul17yLdZvd0QmbhUHN-fcDpocsY04v/export?format=csv&gid=784598513'
    outs:
      - mm/master_2025.csv

  download_and_convert:
    cmd: python scripts/download.py
    deps:
      - scripts/download.py
    outs:
      - data/processed/taxon.parquet
      - data/processed/master_2025.parquet
      - data/processed/ecdysis_wa.parquet

  fetch_inat_links:
    cmd: python scripts/fetch_inat_links.py
    deps:
      - scripts/fetch_inat_links.py
      - data/processed/ecdysis_wa.parquet
    outs:
      - data/processed/ecdysis_inat_links.parquet
